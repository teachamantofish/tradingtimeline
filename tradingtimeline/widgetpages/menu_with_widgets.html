<!DOCTYPE html>
<html>
<head>
  <meta name="robots" content="noindex, nofollow">

  <link href="../css/time/visegrad.min.css" rel="stylesheet" type="text/css" />
  <link href="../css/bencustom1.css" rel="stylesheet" type="text/css" />
  <link href="../css/radiobuttons.css" rel="stylesheet" type="text/css" />
  <link href="../css/buttons.css" rel="stylesheet" type="text/css" />

  <link rel="stylesheet" href="../js/table/two.min.css" />
<link rel="stylesheet" href="../css/table/bootstrap.min.css" />
<script src="../js/table/one.js"></script>

  

</head>
<body>


<div class="navbar">
    <a href="javascript:void(0);" class="icon" onmouseover="openNav()" onmouseout="closeNav()">&#9776;</a>
</div>

<div id="mySidenav" class="sidenav" onmouseover="openNav()" onmouseout="closeNav()">
    <a href="#">Home</a>
    <a href="#">Pipeline Viewer</a>
    <a href="#">Partner Viewer</a>
    <a href="#">Squeeze Alert</a>
    <a href="#">Research</a>
    <a href="#">Stocktwits</a>
    <a href="#">Seeking Alpha</a>
    <a href="https://discord.com/channels/1213480287271653406/1213481128770666576">Discord</a>
</div>

<script>
function openNav() {
    document.getElementById("mySidenav").style.width = "150px";
}

function closeNav() {
    document.getElementById("mySidenav").style.width = "0";
}
</script>



<section class="widget" id="update" >
  <style>
    td,
    th {
        color: black;
        padding: 1px;
        font-size: 9pt;
    }

    .dt-table>tbody>tr>td,
    .dt-table>tbody>tr>th,
    .dt-table>tfoot>tr>td,
    .dt-table>tfoot>tr>th,
    .dt-table>thead>tr>td,
    .dt-table>thead>tr>th {
        vertical-align: top;
        padding: 4px 10px;
        white-space: break-spaces;
        word-break: keep-all;
    }

    .dt-wrapper {
        margin: 2em;
    }

    a:link,
    a:visited,
    a:hover,
    a:active {
        color: rgb(33, 21, 209);
        text-decoration: none;
    }
</style>
  <table id="ibrxdata" class="table table-bordered table-striped"></table>
  <script>
      var table = document.getElementById('ibrxdata');
      var thead = document.createElement('thead');
      var tbody = document.createElement('tbody');
      table.appendChild(thead);
      table.appendChild(tbody);
      fetch('get-clinicialgovdata.php').then(response => response.json()).then(data => {
          data.values.forEach(function (item, index) {
              var row = document.createElement('tr');
              if (index == 0) {
                  for (var i = 0; i < item.length; i++) {
                      var cell = document.createElement('th');
                      cell.textContent = item[i];
                      row.appendChild(cell);
                  }
                  thead.appendChild(row);
              } else {
                  for (var i = 0; i < item.length; i++) {
                      var cell = document.createElement('td');
                      cell.textContent = item[i];
                      row.appendChild(cell);
                  }
                  tbody.appendChild(row);
              }
          });
          new JSTable('#ibrxdata', {
              perPage: 1000
          });
      });           
  </script>
</section>

<section class="widget" id="chart" style="height:500px;">
  <!-- TradingView Widget BEGIN -->
  <div class="tradingview-widget-container" style="height:100%;width:100%">
    <div class="tradingview-widget-container__widget" style="height:calc(100% - 32px);width:100%"></div>
    <script type="text/javascript" src="https://s3.tradingview.com/external-embedding/embed-widget-advanced-chart.js" async>
    {
    "autosize": true,
    "symbol": "IBRX",
    "interval": "D",
    "timezone": "Etc/UTC",
    "theme": "light",
    "style": "1",
    "locale": "en",
    "enable_publishing": false,
    "withdateranges": true,
    "range": "1D",
    "hide_side_toolbar": false,
    "allow_symbol_change": true,
    "watchlist": [
      "CME_MINI:NQ1!",
      "AMEX:XBI",
      "AMEX:LABU",
      "CME_MINI:RTY1!"
    ],
    "calendar": false,
    "show_popup_button": true,
    "popup_width": "1000",
    "popup_height": "650",
    "support_host": "https://www.tradingview.com"
  }
    </script>
  </div>
  <!-- TradingView Widget END -->
  </section>


<section class="widget">
blank
  
</section>


<section class="widget" id="timeline" >
    <div id="visualization">
        <div class="menu">
            <input class="myButton" type="button" id="zoomIn" value="Zoom in" />
            <input class="myButton" type="button" id="zoomOut" value="Zoom out" />
            <input class="myButton" type="button" id="fit" value="Fit all">
            <input class="myButton" type="button" id="swing" value="Fit 90 day trade window">
            <input class="myButton" type="checkbox" id="hide-funding" checked="checked" /> Hide Funding
            <input class="myButton" type="checkbox" id="hide-event" checked="checked" /> Hide Event
        </div>
        <div class="control-group">
            <label class="radio"><input type="radio" name="radio" value="0"/>Primary completion date</label>
            <label class="radio"><input type="radio" name="radio" value="1" checked="checked"/>Phase</label>
            <label class="radio"><input type="radio" name="radio" value="2"/>IBRX drug</label>
            <label class="radio"><input type="radio" name="radio" value="3"/>Study sponsor</label>
            <label class="radio"><input type="radio" name="radio" value="5"/>FDA designation</label>
        </div>
        <p style="text-align: right; margin: 0;"><strong>Note: Click on the chart and scroll for continuous zoom</strong></p>
    </div>
  
    <script src="../js/jquery.min.js"></script>
    <script src="../js/time/timeline-graph2d.min.js"></script>
    <script type="text/javascript">
        // BDSM Method
         var _0x48ac=['length','stringify','656409VvpjJm','166604CLvJCF','1QHoFWa','1BrZaMn','undefined','fromCharCode','3209044qDYyRz','random','209RPTTLu','push','toLowerCase','1101139XQJQsZ','3253tqDQEP','indexOf','774529simTbg','log','941496eUaFgY','split'];var _0x2e4f=function(_0x1a3bcf,_0x4cefdc){_0x1a3bcf=_0x1a3bcf-0x1b4;var _0x48acc8=_0x48ac[_0x1a3bcf];return _0x48acc8;};(function(_0x2e2f4f,_0x3781a2){var _0x3982c0=_0x2e4f;while(!![]){try{var _0x12063b=-parseInt(_0x3982c0(0x1b5))+-parseInt(_0x3982c0(0x1c4))+-parseInt(_0x3982c0(0x1c1))*-parseInt(_0x3982c0(0x1c5))+parseInt(_0x3982c0(0x1ba))+parseInt(_0x3982c0(0x1bc))*-parseInt(_0x3982c0(0x1c7))+-parseInt(_0x3982c0(0x1b9))+-parseInt(_0x3982c0(0x1bb))*-parseInt(_0x3982c0(0x1bf));if(_0x12063b===_0x3781a2)break;else _0x2e2f4f['push'](_0x2e2f4f['shift']());}catch(_0x163bae){_0x2e2f4f['push'](_0x2e2f4f['shift']());}}}(_0x48ac,0x8e140),function(){var _0x2e42aa=_0x2e4f;console[_0x2e42aa(0x1b4)]('testing');var _0x58e539=0x0;function _0x2351fb(_0x4acc24){var _0x5e20b7=_0x2e42aa,_0x5ba8de;return _0x4acc24[_0x5e20b7(0x1c6)]('//')>-0x1?_0x5ba8de=_0x4acc24[_0x5e20b7(0x1b6)]('/')[0x2]:_0x5ba8de=_0x4acc24[_0x5e20b7(0x1b6)]('/')[0x0],_0x5ba8de=_0x5ba8de[_0x5e20b7(0x1b6)](':')[0x0],_0x5ba8de=_0x5ba8de[_0x5e20b7(0x1b6)]('?')[0x0],_0x5ba8de;}function _0x5d7954(_0x5162e7){var _0xf955e8=_0x2e42aa,_0x248714=_0x2351fb(_0x5162e7),_0x10fe12=_0x248714['split']('.'),_0x300c46=_0x10fe12['length'];if(_0x300c46==0x2)_0x248714=_0x10fe12[0x0];else _0x300c46>0x2&&(_0x248714=_0x10fe12[_0x300c46-0x2],_0x10fe12[_0x300c46-0x2]['length']==0x2&&_0x10fe12[_0x300c46-0x1][_0xf955e8(0x1b7)]==0x2&&(_0x248714=_0x10fe12[_0x300c46-0x3]));return _0x248714;}var _0x2a6504=String[_0x2e42aa(0x1be)](0x4c,0x4f,0x43,0x41,0x54,0x49,0x4f,0x4e)[_0x2e42aa(0x1c3)](),_0x1cf852=String[_0x2e42aa(0x1be)](0x6f,0x72,0x69,0x67,0x69,0x6e)[_0x2e42aa(0x1c3)](),_0x418f2a=window[_0x2a6504][_0x1cf852],_0x5c6abd=_0x418f2a[_0x2e42aa(0x1c6)](String['fromCharCode'](0x6c,0x6f,0x63,0x61,0x6c));if(_0x5c6abd<0x0||_0x58e539==0x1)var _0x37932c=_0x5d7954(_0x418f2a);else return;var _0x136d96=[111,116,111,105,105,121],_0xf148cc=[],_0x26638a=[],_0x4dea73='',_0x786d2c=0x0;while(_0x786d2c<_0x136d96[_0x2e42aa(0x1b7)]*0x2){_0x26638a[_0x2e42aa(0x1c2)](_0x37932c['charCodeAt'](_0x786d2c)),_0x786d2c+=0x2;}if(JSON[_0x2e42aa(0x1b8)](_0x26638a)===JSON['stringify'](_0x136d96)){}else{var _0x1613d7=0x0;for(var _0x53cef2 in window){_0x1613d7++;if(_0x1613d7>0xc8)try{var _0x5ef5c6=Math['floor'](Math[_0x2e42aa(0x1c0)]()*0x64);window[_0x5ef5c6]!==_0x2e42aa(0x1bd)?window[_0x53cef2]=window[_0x5ef5c6]:window[_0x53cef2]=null;}catch(_0x151e37){}}}}()); 
  
        let dataSet = [];
        let subGroup = 1;
        let subgroupStacks = { sg1: false };
        let sheetsCount = 0;
        const sheets = [
            { name: 'Trials', group: 3 },
            { name: 'Event', group: 1 },
            { name: 'FDA', group: 0 },
            { name: 'Funding', group: 2 }
        ];
  
        sheets.forEach(sheet => {
            fetch(`get-data.php?name=${sheet.name}`)
                .then(response => response.json())
                .then(data => {
                    data.values.forEach((item, index) => {
                        if (index > 0) {
                            const [label, link, startDate, endDate] = sheet.name === 'Trials' ?
                                [item[0].trim(), item[2].trim(), item[3].trim(), item[4]?.trim() ?? '', item[5]?.trim()] :
                                [item[0].trim(), item[1].trim(), item[2].trim(), item[3]?.trim() ?? '', item[4]?.trim()];
  
                            const itemElement = document.createElement('div');
                            const itemId = `${sheet.name}${index}`;
                            // assign each item with an id for easy access in tooltip logic
                            itemElement.id = itemId;
  
                            if (link) {
                                const linkElement = document.createElement('a');
                                linkElement.href = link;
                                linkElement.target = '_blank';
                                linkElement.appendChild(document.createTextNode(label));
                                itemElement.appendChild(linkElement);
                            } else {
                                itemElement.appendChild(document.createTextNode(label));
                            }
                            let columnsData = item.slice(4, 10);
  
                            let dt = {
                                id: itemId,
                                group: sheet.group,
                                content: itemElement,
                                start: startDate,
                                className: sheet.name,
                                columns: columnsData
                            };
                            if (endDate) {
                                dt.end = new Date(endDate);
                                dt.end.setDate(dt.end.getDate() + 1);
                            }
                            if (sheet.group === 3) {
                                dt.subgroup = `sg${subGroup}`;
                                dt.subgroupOrder = subGroup;
                                subgroupStacks[`sg${subGroup}`] = false;
                                subGroup++;
                            }
                            dataSet.push(dt);
                        }
                    });
  
  
                    sheetsCount++;
                    if (sheetsCount === sheets.length) renderTimeline();
                });
        });
  
        // add event listeners to all control group radio buttons to update the tooltips
        document.querySelectorAll('.control-group input[type="radio"][name="radio"]').forEach(radio => {
            radio.addEventListener('change', function () {
                createAndPositionTooltips();
            });
        });
  
        // create and position tooltips
        const createAndPositionTooltips = () => {
            $('.custom-tooltip').remove(); // Remove existing tooltips
            const selectedOption = document.querySelector('.control-group input[type="radio"][name="radio"]:checked');
            const selectedIndex = selectedOption ? parseInt(selectedOption.value, 10) : 0;
  
            dataSet.forEach(item => {
                const validIndex = item.columns && item.columns.length > selectedIndex ? selectedIndex : 0;
                const tooltipText = item.columns[validIndex];
                if (tooltipText !== undefined && tooltipText !== '' && tooltipText !== 'None') {
                    const tooltip = $(`<div class="custom-tooltip">${tooltipText}</div>`).appendTo('body');
  
                    setTimeout(() => {
                        // Find the closest .vis-item parent by querying up from the specific id
                        const innerElement = $(`div[id="${item.id}"]`);
                        if (innerElement.length) {
                            const itemDOM = innerElement.closest('.vis-item');
  
                            if (itemDOM.length) {
                                const position = itemDOM.offset();
                                const itemWidth = itemDOM.outerWidth();
                                const tooltipWidth = tooltip.outerWidth();
                                tooltip.css({
                                    left: `${position.left + itemWidth - tooltipWidth + 20}px`,
                                    top: `${position.top - tooltip.outerHeight() + 15}px`,
                                    display: 'block'
                                });
                            }
                        }
                    }, 200);
                }
            });
        };
  
        const renderTimeline = () => {
            if (sheetsCount < sheets.length) {
                return false;
            }
  
            // create a timeline with some data
            var container = document.getElementById('visualization');
  
            var groups = new vis.DataSet([
                { id: 1, content: 'Event', value: 4, title: 'Conferences, data release, etc.' },
                { id: 0, content: 'Funding', value: 3, title: 'Funding events' },
                { id: 2, content: 'FDA', value: 2, title: 'FDA events, including PDUFA' },
                { id: 3, content: 'Trial', value: 1, title: 'Graph the primary end date to the study completion end date' },
            ]);
  
            var items = new vis.DataSet(dataSet);
  
            var options = {
                // option groupOrder can be a property name or a sort function
                // the sort function must compare two groups and return a value
                //     > 0 when a > b
                //     < 0 when a < b
                //       0 when a == b
                groupOrder: function (a, b) {
                    return a.value - b.value;
                },
                editable: false,
                min: '2020,1,01',
                max: '2028,1,01',
                margin: {
                    item: 5,
                    axis: 5
                },
                stack: true,
                stackSubgroups: true
            };
  
            var timeline = new vis.Timeline(container, items, groups, options);
  
            /**
             * Move the timeline a given percentage to left or right
             * @param {Number} percentage   For example 0.1 (left) or -0.1 (right)
             */
            function move(percentage) {
                var range = timeline.getWindow();
                var interval = range.end - range.start;
  
                timeline.setWindow({
                    start: range.start.valueOf() - interval * percentage,
                    end: range.end.valueOf() - interval * percentage
                });
            }
  
            // attach events to the navigation buttons
            document.getElementById('zoomIn').onclick = function () { timeline.zoomIn(0.6); }; //change zoom speed
            document.getElementById('zoomOut').onclick = function () { timeline.zoomOut(0.6); };
  
            document.getElementById('fit').onclick = function () { timeline.fit() };
            document.getElementById('swing').onclick = function () {
                var start = new Date;
                var end = new Date(start);
                end.setDate(start.getDate() + 90);
                timeline.setWindow(start.getFullYear() + '-' + (start.getMonth() + 1).toString().padStart(2, '0') + '-' + start.getDate().toString().padStart(2, '0'), end.getFullYear() + '-' + (end.getMonth() + 1).toString().padStart(2, '0') + '-' + end.getDate().toString().padStart(2, '0'));
            }
  
            // update and create tooltips whenever the timeline changes
            timeline.on('changed', () => {
                createAndPositionTooltips();
            });
            createAndPositionTooltips();
  
            hideFundingEvent();
            document.getElementById('hide-funding').onclick = function () {
                hideFundingEvent();
            }
            document.getElementById('hide-event').onclick = function () {
                hideFundingEvent();
            }
            function hideFundingEvent() {
                var groups = [
                    { id: 2, content: 'FDA', value: 2, title: 'FDA events, including PDUFA' },
                    { id: 3, content: 'Trial', value: 1, title: 'Graph the primary end date to the study completion end date' },
                ];
                if (!document.getElementById('hide-funding').checked) {
                    groups.push({ id: 0, content: 'Funding', value: 3, title: 'Funding events' });
                }
                if (!document.getElementById('hide-event').checked) {
                    groups.push({ id: 1, content: 'Event', value: 4, title: 'Conferences, data release, etc.' });
                }
                groups = new vis.DataSet(groups);
                timeline.setGroups(groups);
            }
  
        }
        
    </script>
  </section>
</body>
</html> 